<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Codenem</title>
</head>
<body>
  <div class="app"></div>
  <div class="infos"> Scroll to reveal the rock.</div>
  <div class="credits">
    <h1 class="credits__title">shaolin405</h1>
    <p class="credits__wrapper">
      <a href="https://twitter.com/avanderpotte" target="_blank" class="credits__link">avanderpotte</a> â˜“ <a href="https://twitter.com/leixng" target="_blank" class="credits__link">leixng</a>
    </p>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/87/three.min.js"></script>
  <script src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/127738/OrbitControls.js"></script>
  <script type="x-shader/vertex-shader" id="sphereVertex">
    uniform float uTime;
    uniform float uTransition;
    uniform sampler2D uTexture;
    varying vec2 vUv;
    varying vec4 texture;
    varying float bw;

    float PI = 3.14159265;
    float TWOPI = 6.28318531;
    float baseRadius = 10.0;

    vec3 sphere( float u, float v) {
      u *= PI;
      v *= TWOPI;
      vec3 pSphere;
      pSphere.x = baseRadius * cos(v) * sin(u);
      pSphere.y = baseRadius * sin(v) * sin(u);
      pSphere.z = baseRadius * cos(u);
      return pSphere;
    }

    void main() {
      vUv = uv;
      vec3 spherePos = sphere( uv.x, uv.y );
      texture = texture2D( uTexture, uv );
      bw = ( texture.x + texture.y + texture.z ) / 2.0 ;
      vec3 originalPos = position + normal * bw * 10.0;
      vec3 newPosition = spherePos + normal * bw * 10.0;
      vec3 pos = mix( originalPos, -newPosition, uTransition );
      gl_Position = projectionMatrix * modelViewMatrix * vec4( pos, 1.0 );
    }
  </script>
  <script type="x-shader/fragment-shader" id="sphereFragment">
    uniform float uTime;
    uniform sampler2D uTexture;
    varying vec2 vUv;
    varying vec4 texture;
    varying float bw;
    void main() {
      float col = bw;
      vec4 bwColor = vec4( col, col, col, .9 );
      gl_FragColor = bwColor;
    }
  </script>
  <script src="app.bundle.js"></script>
</body>
</html>